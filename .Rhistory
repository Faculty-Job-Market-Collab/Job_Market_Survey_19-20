fig6ef_data %>%
count(peer, grant) %>%
spread(key = grant, value = n) %>%
mutate(total = yes + no,
percent = get_percent(yes, total),
peer_count = paste0(peer, "\n(n = ", total, ")")) %>%
ggplot(aes(x=fct_reorder(peer_count, percent), y = as.numeric(percent),
fill = peer))+
geom_col()+
coord_flip()+
scale_fill_manual(labels = peer_breaks,
values = peer_color)+
scale_y_continuous(expand = c(0,0))+
labs(y="Percent of responses\nby PEER status",
x="Applicants that recieved a grant",
subtitle = paste0("Pearson's Chi-squared test with\nYates' continuity correction\np>0.05"))+
my_theme_horiz+
right_margin
fig6ef_data %>%
count(peer, grant) %>%
spread(key = grant, value = n) %>%
mutate(total = yes + no,
percent = get_percent(yes, total),
peer_count = paste0(peer, "\n(n = ", total, ")")) %>%
ggplot(aes(x=fct_reorder(peer_count, n), y = as.numeric(percent),
fill = peer))+
geom_col()+
coord_flip()+
scale_fill_manual(labels = peer_breaks,
values = peer_color)+
scale_y_continuous(expand = c(0,0))+
labs(y="Percent of responses\nby PEER status",
x="Applicants that recieved a grant",
subtitle = paste0("Pearson's Chi-squared test with\nYates' continuity correction\np>0.05"))+
my_theme_horiz+
right_margin
fig6ef_data %>%
count(peer, grant) %>%
spread(key = grant, value = n) %>%
mutate(total = yes + no,
percent = get_percent(yes, total),
peer_count = paste0(peer, "\n(n = ", total, ")")) %>%
ggplot(aes(x=fct_reorder(peer_count, total), y = as.numeric(percent),
fill = peer))+
geom_col()+
coord_flip()+
scale_fill_manual(labels = peer_breaks,
values = peer_color)+
scale_y_continuous(expand = c(0,0))+
labs(y="Percent of responses\nby PEER status",
x="Applicants that recieved a grant",
subtitle = paste0("Pearson's Chi-squared test with\nYates' continuity correction\np>0.05"))+
my_theme_horiz+
right_margin
fig6ef_data %>%
count(peer, grant) %>%
spread(key = grant, value = n)
fig6d_plot <- fig6ef_data %>%
count(peer, grant) %>%
spread(key = grant, value = n) %>%
mutate(total = yes + no,
percent = get_percent(yes, total),
peer_count = paste0(peer, "\n(n = ", total, ")")) %>% View()
fig6ef_data %>%
count(peer, grant) %>%
spread(key = grant, value = n) %>%
mutate(total = yes + no,
percent = get_percent(yes, total),
peer_count = paste0(peer, "\n(n = ", total, ")")) %>% View()
ggplot(aes(x=fct_reorder(peer_count, total),
y = as.numeric(percent),
fill = peer))+
geom_col()
fig6ef_data %>%
count(peer, grant) %>%
spread(key = grant, value = n) %>%
mutate(total = yes + no,
percent = get_percent(yes, total),
peer_count = paste0(peer, "\n(n = ", total, ")")) %>%
ggplot(aes(x=fct_reorder(peer_count, total),
y = as.numeric(percent),
fill = peer))+
geom_col()
fig6ef_data %>%
count(peer, grant) %>%
spread(key = grant, value = n) %>%
mutate(total = yes + no,
percent = get_percent(yes, total),
peer_count = paste0(peer, "\n(n = ", total, ")")) %>%
ggplot(aes(x=fct_reorder(peer_count, total),
y = as.numeric(percent),
fill = peer))+
geom_col()+
coord_flip()+
scale_fill_manual(labels = peer_breaks,
values = peer_color)
fig6ef_data %>%
count(peer, grant) %>%
spread(key = grant, value = n) %>%
mutate(total = yes + no,
percent = get_percent(yes, total),
peer_count = paste0(peer, "\n(n = ", total, ")")) %>%
ggplot(aes(x=peer_count,
y = as.numeric(percent),
fill = peer))+
geom_col()+
coord_flip()+
scale_fill_manual(labels = peer_breaks,
values = peer_color)
fig6ef_data %>%
count(peer, grant) %>%
spread(key = grant, value = n) %>%
mutate(total = yes + no,
percent = get_percent(yes, total),
peer_count = paste0(peer, "\n(n = ", total, ")")) %>%
ggplot(aes(x=peer_count,
y = as.numeric(percent),
fill = peer_count))+
geom_col()+
coord_flip()+
scale_fill_manual(labels = peer_breaks,
values = peer_color)
fig6ef_data %>%
count(peer, grant) %>%
spread(key = grant, value = n) %>%
mutate(total = yes + no,
percent = get_percent(yes, total),
peer_count = paste0(peer, "\n(n = ", total, ")")) %>%
ggplot(aes(x=peer,
y = as.numeric(percent),
fill = peer))+
geom_col()+
coord_flip()+
scale_fill_manual(labels = peer_breaks,
values = peer_color)
fig6ef_data %>%
count(peer, grant) %>%
spread(key = grant, value = n) %>%
mutate(total = yes + no,
percent = get_percent(yes, total),
peer_count = paste0(peer, "\n(n = ", total, ")")) %>%
ggplot(aes(x=peer,
y = as.numeric(percent),
fill = peer))+
geom_col()+
#coord_flip()+
scale_fill_manual(labels = peer_breaks,
values = peer_color)
fig6ef_data %>%
count(peer, grant) %>%
spread(key = grant, value = n) %>%
mutate(total = yes + no,
percent = get_percent(yes, total),
peer_count = paste0(peer, "\n(n = ", total, ")"),
peer = factor(peer, peer_breaks)) %>%
ggplot(aes(x=peer,
y = as.numeric(percent),
fill = peer))+
geom_col()+
#coord_flip()+
scale_fill_manual(labels = peer_breaks,
values = peer_color)
fig6ef_data %>%
count(peer, grant) %>%
spread(key = grant, value = n) %>%
mutate(total = yes + no,
percent = get_percent(yes, total),
peer_count = paste0(peer, "\n(n = ", total, ")"),
peer = factor(peer, peer_breaks)) %>%
ggplot(aes(x=peer,
y = as.numeric(percent),
fill = peer))+
geom_col()+
coord_flip()+
scale_fill_manual(labels = peer_breaks,
values = peer_color)+
scale_y_continuous(expand = c(0,0))+
labs(y="Percent of responses\nby PEER status",
x="Applicants that recieved a grant",
subtitle = paste0("Pearson's Chi-squared test with\nYates' continuity correction\np>0.05"))+
my_theme_horiz+
right_margin
fig6ef_data %>%
count(peer, grant) %>%
spread(key = grant, value = n) %>%
mutate(total = yes + no,
percent = get_percent(yes, total),
peer_count = paste0(peer, "\n(n = ", total, ")"),
peer = factor(peer, peer_breaks)) %>%
ggplot(aes(x=peer_count,
y = as.numeric(percent),
fill = peer))+
geom_col()+
coord_flip()+
scale_fill_manual(labels = peer_breaks,
values = peer_color)+
scale_y_continuous(expand = c(0,0))+
labs(y="Percent of responses\nby PEER status",
x="Applicants that recieved a grant",
subtitle = paste0("Pearson's Chi-squared test with\nYates' continuity correction\np>0.05"))+
my_theme_horiz+
right_margin
fig6ef_data %>%
count(peer, fellowship) %>%
spread(key = fellowship, value = n) %>%
mutate(total = yes + no,
percent = get_percent(yes, total),
peer_count = paste0(peer,
"\n(n = ", total, ")")) %>%
ggplot(aes(x=peer_count, y = as.numeric(percent),
fill = peer))+
geom_col()+
coord_flip()+
scale_fill_manual(labels = peer_breaks,
values = peer_color)
fig6ef_data %>%
count(peer, fellowship) %>%
spread(key = fellowship, value = n) %>%
mutate(total = yes + no,
percent = get_percent(yes, total),
peer_count = paste0(peer,
"\n(n = ", total, ")"),
peer = factor(peer, peer_breaks)) %>%
ggplot(aes(x=peer_count, y = as.numeric(percent),
fill = peer))+
geom_col()+
coord_flip()+
scale_fill_manual(labels = peer_breaks,
values = peer_color)
fig6a_data %>%
filter(question == "first_author_binned") %>%
get_plot_summary(., "peer", "response",
binary = FALSE) %>%
mutate(response = factor(response, levels = bin_levels_small)) %>%
ggplot(aes(x = response, y = percent,
fill = peer))+
geom_col(position = "dodge")+
scale_fill_manual(labels = peer_breaks,
values = peer_color)+
scale_y_continuous(expand = c(0,0))+
labs(x = "Number of first-author papers\n",
y = "Percent of respondents\nby PEER status",
fill = "PEER status",
subtitle = "Mann Whitney U: p>0.05")+
my_theme_leg
fig6a_data %>%
filter(question == "first_author_binned") %>%
get_plot_summary(., "peer", "response",
binary = FALSE)
fig7_data <- ss_tidy_data %>%
select(id, question, response) %>%
filter(question == "simple_gender" | question == "off_site_interviews" |
question == "on_site_interviews" | question == "peer" |
question == "faculty_offers" |
question == "apps_submitted_binned" |
question == "apps_submitted") %>%
distinct() %>%
spread(key = question, value = response) %>%
filter(!is.na(apps_submitted)) %>%
mutate(simple_faculty_offer = case_when(
as.numeric(faculty_offers) == 0 ~ "0",
as.numeric(faculty_offers) >= 1 ~ "1+"
),
simple_faculty_offer = factor(simple_faculty_offer,
levels = c("0", "1+")),
peer = factor(peer, peer_breaks),
simple_gender = factor(simple_gender, gender_simple_breaks))
ss_id_simple_offer <- select(fig7_data, id, simple_faculty_offer)
fig7_data_two <- fig7_data %>%
filter(simple_gender != "No Response")
fig7_data_women <- fig7_data %>%
filter(simple_gender == "Woman/Trans/GNC")
fig7_data_men <- fig7_data %>%
filter(simple_gender == "Man")
fig7_data_peer <- fig7_data %>%
filter(peer == "Yes")
fig7_data_nonpeer <- fig7_data %>%
filter(peer == "No")
fig7_tidy_data <- fig7_data %>%
gather(2:6, key = question, value = response)
offsite_apps_cor_coefs <- cor.test(as.numeric(fig7_data$apps_submitted),
as.numeric(fig7_data$off_site_interviews))
offsite_apps_man_cor_coefs <- cor.test(as.numeric(fig7_data_men$apps_submitted),
as.numeric(fig7_data_men$off_site_interviews))
offsite_apps_wom_cor_coefs <- cor.test(as.numeric(fig7_data_women$apps_submitted),
as.numeric(fig7_data_women$off_site_interviews))
ggplot(data = fig7_data_two, aes(x = as.numeric(fig7_data_two$apps_submitted),
y = as.numeric(fig7_data_two$off_site_interviews))) +
geom_point(aes(fill = simple_gender, color = simple_gender)) +
scale_fill_manual(values = gender_color)+
scale_color_manual(values = gender_color)+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(expand = c(0,0))
ggplot(data = fig7_data_two, aes(x = as.numeric(fig7_data_two$apps_submitted),
y = as.numeric(fig7_data_two$off_site_interviews))) +
geom_point(aes(fill = simple_gender, color = simple_gender)) +
scale_fill_manual(values = gender_color)+
scale_color_manual(values = gender_color)+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(expand = c(0,0))+
geom_smooth(method=lm, se=TRUE, color="black", fill="#999999") +
geom_smooth(aes(fill = simple_gender, color = simple_gender), method=lm, se=TRUE) +
annotate("text", x = 100, y = 16,
label = paste0("R: ", round(offsite_apps_cor_coefs$estimate, 2))) +
annotate("text", x = 100, y = 15,
label = paste0("p-value: ", round(offsite_apps_cor_coefs$p.value, 25)))+
annotate("text", x = 80, y = 5, color = "#D55E00",
label = paste0("R: ", round(offsite_apps_man_cor_coefs$estimate, 2))) +
annotate("text", x = 80, y = 4, color = "#D55E00",
label = paste0("p-value: ", round(offsite_apps_man_cor_coefs$p.value, 10)))+
annotate("text", x = 130, y = 11, color = "#009E73",
label = paste0("R: ", round(offsite_apps_wom_cor_coefs$estimate, 2))) +
annotate("text", x = 130, y = 10, color = "#009E73",
label = paste0("p-value: ", round(offsite_apps_wom_cor_coefs$p.value, 20)))+
labs(y = "Number of off-site interviews",
x = "Number of applications submitted")+
my_theme_horiz
onsite_apps_cor_coefs <- cor.test(as.numeric(fig7_data$apps_submitted),
as.numeric(fig7_data$on_site_interviews))
onsite_apps_man_cor_coefs <- cor.test(as.numeric(fig7_data_men$apps_submitted),
as.numeric(fig7_data_men$on_site_interviews))
onsite_apps_wom_cor_coefs <- cor.test(as.numeric(fig7_data_women$apps_submitted),
as.numeric(fig7_data_women$on_site_interviews))
ggplot(data = fig7_data_two, aes(x = as.numeric(fig7_data_two$apps_submitted),
y = as.numeric(fig7_data_two$on_site_interviews))) +
geom_point(aes(fill = simple_gender, color = simple_gender)) +
scale_fill_manual(values = gender_color)+
scale_color_manual(values = gender_color)+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(expand = c(0,0))+
geom_smooth(method=lm, se=TRUE, color="black", fill="#999999") +
geom_smooth(aes(fill = simple_gender, color = simple_gender), method=lm, se=TRUE) +
annotate("text", x = 130, y = 2.5,
label = paste0("R: ", round(onsite_apps_cor_coefs$estimate, 2))) +
annotate("text", x = 130, y = 2.3,
label = paste0("p-value: ", round(onsite_apps_cor_coefs$p.value, 5)))+
annotate("text", x = 80, y = .75, color = "#D55E00",
label = paste0("R: ", round(onsite_apps_man_cor_coefs$estimate, 2))) +
annotate("text", x = 80, y = .25, color = "#D55E00",
label = paste0("p-value: ", round(onsite_apps_man_cor_coefs$p.value, 5)))+
annotate("text", x = 120, y = 6, color = "#009E73",
label = paste0("R: ", round(onsite_apps_wom_cor_coefs$estimate, 2))) +
annotate("text", x = 120, y = 5.7, color = "#009E73",
label = paste0("p-value: ", round(onsite_apps_wom_cor_coefs$p.value, 5)))+
labs(y = "Number of on-site interviews", x = "Number of applications submitted",
fill = "Gender", color = "Gender")+
my_theme_horiz
ggplot(data = fig7_data_two, aes(x = as.numeric(fig7_data_two$apps_submitted),
y = as.numeric(fig7_data_two$on_site_interviews))) +
geom_point(aes(fill = simple_gender, color = simple_gender)) +
scale_fill_manual(values = gender_color)+
scale_color_manual(values = gender_color)+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(expand = c(0,0))+
geom_smooth(method=lm, se=TRUE, color="black", fill="#999999") +
geom_smooth(aes(fill = simple_gender, color = simple_gender), method=lm, se=TRUE)
ggplot(data = fig7_data_two, aes(x = as.numeric(fig7_data_two$apps_submitted),
y = as.numeric(fig7_data_two$on_site_interviews))) +
geom_point(aes(fill = simple_gender, color = simple_gender)) +
scale_fill_manual(values = gender_color)+
scale_color_manual(values = gender_color)+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(expand = c(0,0))+
geom_smooth(method=lm, se=TRUE, color="black", fill="#999999") +
geom_smooth(aes(fill = simple_gender, color = simple_gender), method=lm, se=TRUE)+
annotate("text", x = 130, y = 2.5,
label = paste0("R: ", round(onsite_apps_cor_coefs$estimate, 2))) +
annotate("text", x = 130, y = 2.3,
label = paste0("p-value: ", round(onsite_apps_cor_coefs$p.value, 5)))+
annotate("text", x = 80, y = .75, color = "#D55E00",
label = paste0("R: ", round(onsite_apps_man_cor_coefs$estimate, 2)))
ggplot(data = fig7_data_two, aes(x = as.numeric(fig7_data_two$apps_submitted),
y = as.numeric(fig7_data_two$on_site_interviews))) +
geom_point(aes(fill = simple_gender, color = simple_gender)) +
scale_fill_manual(values = gender_color)+
scale_color_manual(values = gender_color)+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(expand = c(0,0))+
geom_smooth(method=lm, se=TRUE, color="black", fill="#999999") +
geom_smooth(aes(fill = simple_gender, color = simple_gender), method=lm, se=TRUE)+
annotate("text", x = 130, y = 2.5,
label = paste0("R: ", round(onsite_apps_cor_coefs$estimate, 2))) +
annotate("text", x = 130, y = 2.3,
label = paste0("p-value: ", round(onsite_apps_cor_coefs$p.value, 5)))+
annotate("text", x = 80, y = .75, color = "#009E73",
label = paste0("R: ", round(onsite_apps_man_cor_coefs$estimate, 2)))
ggplot(data = fig7_data, aes(x = as.numeric(fig7_data$apps_submitted),
y = as.numeric(fig7_data$off_site_interviews))) +
geom_point(aes(fill = peer, color = peer)) +
scale_fill_manual(labels = peer_breaks, values = peer_color)+
scale_color_manual(labels = peer_breaks, values = peer_color)+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(expand = c(0,0))+
geom_smooth(method=lm, se=TRUE, color="black", fill="#999999") +
geom_smooth(aes(fill = peer, color = peer), method=lm, se=TRUE)
ggplot(data = fig7_data, aes(x = as.numeric(fig7_data$apps_submitted),
y = as.numeric(fig7_data$off_site_interviews))) +
geom_point(aes(fill = peer, color = peer)) +
scale_fill_manual(labels = peer_breaks, values = peer_color)+
scale_color_manual(labels = peer_breaks, values = peer_color)+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(expand = c(0,0))+
geom_smooth(method=lm, se=TRUE, color="black", fill="#999999") +
geom_smooth(aes(fill = peer, color = peer), method=lm, se=TRUE) +
annotate("text", x = 100, y = 16,
label = paste0("R: ", round(offsite_apps_cor_coefs$estimate, 2))) +
annotate("text", x = 100, y = 15,
label = paste0("p-value: ", round(offsite_apps_cor_coefs$p.value, 5)))+
#peer data
annotate("text", x = 100, y = 5, color = "#E69F00",
label = paste0("R: ", round(offsite_apps_peer_cor_coefs$estimate, 2))) +
annotate("text", x = 100, y = 4, color = "#E69F00",
label = paste0("p-value: ", round(offsite_apps_peer_cor_coefs$p.value, 5)))
ggplot(data = fig7_data, aes(x = as.numeric(fig7_data$apps_submitted),
y = as.numeric(fig7_data$off_site_interviews))) +
geom_point(aes(fill = peer, color = peer)) +
scale_fill_manual(labels = peer_breaks, values = peer_color)+
scale_color_manual(labels = peer_breaks, values = peer_color)+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(expand = c(0,0))+
geom_smooth(method=lm, se=TRUE, color="black", fill="#999999") +
geom_smooth(aes(fill = peer, color = peer), method=lm, se=TRUE) +
annotate("text", x = 100, y = 16,
label = paste0("R: ", round(offsite_apps_cor_coefs$estimate, 2))) +
annotate("text", x = 100, y = 15,
label = paste0("p-value: ", round(offsite_apps_cor_coefs$p.value, 5)))+
#peer data
annotate("text", x = 100, y = 5, color = "#56B4E9",
label = paste0("R: ", round(offsite_apps_peer_cor_coefs$estimate, 2))) +
annotate("text", x = 100, y = 4, color = "#E69F00",
label = paste0("p-value: ", round(offsite_apps_peer_cor_coefs$p.value, 5)))
ggplot(data = fig7_data, aes(x = as.numeric(faculty_offers),
y = as.numeric(on_site_interviews))) +
geom_point(aes(fill = peer, color = peer)) +
scale_fill_manual(labels = peer_breaks, values = peer_color)+
scale_color_manual(labels = peer_breaks, values = peer_color)+
scale_y_continuous(expand = c(0,0))+
scale_x_continuous(expand = c(0,0))+
geom_smooth(method=lm, se=TRUE, color="black", fill="#999999")+
geom_smooth(aes(fill = peer, color = peer), method=lm, se=TRUE)+
annotate("text", x = 4.5, y = 7.5,
label = paste0("R: ", round(onsite_offers_cor_coefs$estimate, 2))) +
annotate("text", x = 4.5, y = 7.2,
label = paste0("p-value: ", round(onsite_offers_cor_coefs$p.value, 25)))+
#peer data
annotate("text", x = 4.5, y = 2.5, color = "#56B4E9",
label = paste0("R: ", round(onsite_offers_peer_cor_coefs$estimate, 2))) +
annotate("text", x = 4.5, y = 2.20, color = "#56B4E9",
label = paste0("p-value: ", round(onsite_offers_peer_cor_coefs$p.value, 10)))+
#nonpeer data
annotate("text", x = 2.5, y = 5.5, color = "#E69F00",
label = paste0("R: ", round(onsite_offers_nonpeer_cor_coefs$estimate, 2))) +
annotate("text", x = 2.5, y = 5.2, color = "#E69F00",
label = paste0("p-value: ", round(onsite_offers_nonpeer_cor_coefs$p.value, 20)))+
labs(y = "Number of on-site interviews", x = "Number of faculty offers",
fill = "PEER identity:", color = "PEER identity:")+
base_theme
metric_data %>%
mutate(question = case_when(
question == "first_author" ~ "First-author papers",
question == "peer-reviewed_papers" ~ "Peer-reviewed papers",
question == "scholar_citations_all" ~ "Google Scholar citations",
question == "scholar_hindex" ~ "Google Scholar H index"
)) %>%
group_by(question, research_category) %>%
ggplot(aes(x = question, y = as.numeric(response),
fill = research_category))+
#geom_dotplot()+
geom_boxplot(position = "dodge")+
scale_fill_manual(breaks = research_breaks, values = cbPalette)+
facet_wrap(~question, scales = "free")+
geom_text(data = metric_medians,
aes(group = research_category, x = question,
y = max*0.8, label = paste("med=", med)),
position=position_dodge(width=1), size = 5)+
scale_y_continuous(expand = c(0,0))+
labs(x = "", y = "Response value per applicant")
teaching_data %>%
count(research_category, question, response) %>%
left_join(., fig1d_group_count,
by = "research_category") %>%
mutate(percent = get_percent(n, total),
question = if_else(question == "teaching_status",
"Teaching experience (n=151)",
"Types of teaching experience")) %>%
ggplot(aes(x = response, y = percent,
fill = research_category))+
geom_col(position = "dodge")+
scale_fill_manual(breaks = research_breaks, values = cbPalette)+
facet_wrap(~question, scale = "free_y", ncol = 1)+
coord_flip()+
scale_y_continuous(expand = c(0,0))
teaching_data %>%
count(research_category, question, response) %>%
left_join(., fig1d_group_count,
by = "research_category")
fig2_tidy_data %>%
ggplot(aes(x = simple_gender, fill = simple_gender,
y = as.numeric(response)))+
geom_boxplot(position = "dodge")+
facet_wrap(~ question, scales = "free_x")+
coord_flip()+
scale_y_continuous(expand = c(0,0))+
scale_fill_manual(breaks = gender_simple_breaks, values = gender_color)
fig2_tidy_data %>%
ggplot(aes(x = peer, fill = peer, y = as.numeric(response)))+
geom_boxplot(position = "dodge")+
facet_wrap(~ question, scales = "free_x")+
coord_flip()+
scale_fill_manual(breaks = peer_breaks, values = peer_color)+
scale_y_continuous(expand = c(0,0))
source("~/Desktop/Job_Market_Survey_19-20/mollet_socialsci/code/get_soc_sci_data.R")
